#!/bin/sh

RTA_HOME="`pwd`/`dirname $0`/../"

JRUBY_CMD=`which jruby`
if [ "$JRUBY_CMD" = "" ]
then
  JRUBY_COMPLETE="$RTA_HOME/lib/jruby/jruby-complete-1.5.5.jar"
  JAVA_MEM=-Xmx500m
  JAVA_STACK=-Xss1024k
  JAVA_VM=-client
  JAVA_OPTS="$JAVA_VM $JAVA_MEM $JAVA_STACK"
  JRUBY_CMD="java $JAVA_OPTS -classpath $JRUBY_COMPLETE:$CLASSPATH org.jruby.Main"
fi


# 引数を配列を表す文字列 argv にする
ARGV=""
for arg in "$@"
do
  arg="'$arg'"
  if [ "$ARGV" = "" ]
  then
    ARGV="$arg"
  else
    ARGV="$ARGV,$arg"
  fi
done

exec $JRUBY_CMD -e "require '$RTA_HOME/lib/rta'; RTA::Controller::Runner.new.run($ARGV)"
